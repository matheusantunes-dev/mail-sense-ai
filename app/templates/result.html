{% if error %}
<div class="alert">
    <p class="alert__title">âš ï¸ {{ error }}</p>
</div>

{% elif result %}
{% set is_prod = (result.category == "Produtivo") %}

<div class="stack">
    <!-- Badge e confianÃ§a -->
    <div class="result-top">
        <span class="badge {% if is_prod %}badge--prod{% else %}badge--improd{% endif %}">
            {% if is_prod %}âœ…{% else %}ğŸ“Œ{% endif %} {{ result.category }}
        </span>
        <span class="confidence">
            ğŸ¯ ConfianÃ§a: {{ (result.confidence * 100) | round(0) }}%
        </span>
    </div>

    <!-- RazÃ£o da classificaÃ§Ã£o -->
    <div class="panel">
        <p class="panel__title">ğŸ¤” Por que essa classificaÃ§Ã£o?</p>
        <p class="panel__text">{{ result.short_reason }}</p>
    </div>

    <!-- Resposta sugerida -->
    <div class="panel">
        <div class="reply-header">
            <p class="panel__title" style="margin:0;">ğŸ’¬ Resposta Sugerida</p>
            <button class="button-small" type="button" onclick="copyReply()">
                ğŸ“‹ Copiar
            </button>
        </div>

        <textarea id="reply" class="textarea" rows="7" readonly>{{ result.user_message }}</textarea>
        <p id="copied" class="copied hidden">âœ… Copiado para a Ã¡rea de transferÃªncia!</p>
    </div>

    <!-- Preview do email -->
    <details class="panel preview">
        <summary>ğŸ‘ï¸ Ver prÃ©via completa do e-mail</summary>
        <pre>{{ email_preview }}</pre>
    </details>

    <!-- BotÃ£o para nova anÃ¡lise -->
    <div style="text-align: center; margin-top: 8px;">
        <button class="button-small" onclick="document.querySelector('textarea[name=email_text]').focus()">
            ğŸ”„ Analisar outro email
        </button>
    </div>
</div>

{% else %}
<div class="result-empty">
    <div class="result-empty__icon">ğŸ“¬</div>
    <p><b>Nenhum resultado ainda</b></p>
    <p>Envie um e-mail para anÃ¡lise usando o formulÃ¡rio ao lado.</p>
</div>
{% endif %}
